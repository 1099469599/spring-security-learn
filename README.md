本代码相关笔记见：http://note.youdao.com/noteshare?id=b44957bfd568e9e1bf8e569d9ba91d68